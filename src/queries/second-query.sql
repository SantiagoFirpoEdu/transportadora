--Listar o nome dos clientes, o número, a data de saída, a placa do caminhão
-- e o nome do motorista de suas entregas, bem como a descrição e o nome das
-- categorias dos itens entregues, apenas para as entregas efetuadas no corrente ano,
-- para clientes do Rio Grande do Sul e que tenham valor do prêmio de apólice de seguro
-- pelo menos R$ 100.000,00.
SELECT CC105613.CLIENTES.NOME AS NOME_DO_CLIENTE,
       CC105613.ENTREGAS.ID_ENTREGA,
       CC105613.ENTREGAS.DATA_SAIDA,
       CC105613.ENTREGAS.PLACA,
       CC105613.MOTORISTAS.NOME AS NOME_DO_MOTORISTA,
       CC105613.CATEGORIAS_ITEM.DESCRICAO

FROM CC105613.ENTREGAS
         INNER JOIN CC105613.CLIENTES ON CC105613.CLIENTES.ID_CLIENTE = CC105613.ENTREGAS.ID_CLIENTE
         INNER JOIN CC105613.APOLICES ON CC105613.APOLICES.ID_CLIENTE = CC105613.CLIENTES.ID_CLIENTE
         INNER JOIN CC105613.ENDERECOS ON CC105613.ENDERECOS.ID_CLIENTE = CC105613.CLIENTES.ID_CLIENTE
         INNER JOIN CC105613.CAMINHOES ON CC105613.ENTREGAS.PLACA = CC105613.CAMINHOES.PLACA
         INNER JOIN CC105613.CONDUCOES ON CC105613.ENTREGAS.ID_ENTREGA = CC105613.CONDUCOES.ID_ENTREGA
         INNER JOIN CC105613.MOTORISTAS ON CC105613.CONDUCOES.CNH = CC105613.MOTORISTAS.CNH
         INNER JOIN CC105613.REMESSAS ON CC105613.ENTREGAS.ID_ENTREGA = CC105613.REMESSAS.ID_ENTREGA
         INNER JOIN CC105613.ITENS ON CC105613.REMESSAS.ID_ITEM = CC105613.ITENS.ID_ITEM
         INNER JOIN CC105613.CATEGORIZACOES ON CC105613.ITENS.ID_ITEM = CC105613.CATEGORIZACOES.ID_ITEM
         INNER JOIN CC105613.CATEGORIAS_ITEM ON CC105613.CATEGORIZACOES.ID_CATEGORIA = CC105613.CATEGORIAS_ITEM.ID_CATEGORIA

WHERE EXTRACT(YEAR FROM DATA_CHEGADA) = EXTRACT(YEAR FROM SYSDATE)
  AND CC105613.ENDERECOS.UNIDADE_FEDERATIVA = 'RS'
  AND CC105613.APOLICES.VALOR_PREMIO >= 100000;
